# Data Preparation
python scripts/prepare_movielens.py \
  --output-dir data/movielens_qwen3 \
  --history-len 15 \
  --rating-threshold 4.0

# Training - GPU (Full)
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name experiment-1 \
  --device cuda

# Training - GPU (Reduced Memory)
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name experiment-1 \
  --device cuda \
  --override per_device_train_batch_size=1 \
  --override gradient_accumulation_steps=1

# Training - CPU (Testing Only)
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_cpu.yaml \
  --run-name cpu-test \
  --device cpu \
  --override per_device_train_batch_size=1 \
  --override gradient_accumulation_steps=1 \
  --override bf16=false

# Resume Training from Latest Checkpoint
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name experiment-1 \
  --device cuda \
  --override per_device_train_batch_size=1 \
  --override gradient_accumulation_steps=1 \
  --override resume_from_checkpoint=output/qwen3-movielens-qlora/checkpoint-1000

# Resume Training from Specific Checkpoint
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name experiment-1 \
  --device cuda \
  --override per_device_train_batch_size=1 \
  --override gradient_accumulation_steps=1 \
  --override resume_from_checkpoint=output/qwen3-movielens-qlora/checkpoint-800

# Resume Training - Auto-detect Latest Checkpoint
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name experiment-1 \
  --device cuda \
  --override per_device_train_batch_size=1 \
  --override gradient_accumulation_steps=1 \
  --override resume_from_checkpoint=true

# Custom Training Overrides
python scripts/train_llamafactory.py \
  --config configs/qwen3_movielens_qlora.yaml \
  --run-name custom-experiment \
  --device cuda \
  --override learning_rate=2e-4 \
  --override num_train_epochs=5 \
  --override lora_rank=32 \
  --override save_steps=500

# TensorBoard Monitoring
tensorboard --logdir output/qwen3-movielens-qlora/runs --port 6006

# Check GPU Usage
nvidia-smi

# Watch GPU Usage in Real-time
watch -n 1 nvidia-smi

# View Training Logs
tail -f output/qwen3-movielens-qlora/trainer_log.jsonl

# List Available Checkpoints
ls -lh output/qwen3-movielens-qlora/checkpoint-*/

# Check Checkpoint Contents
ls -lh output/qwen3-movielens-qlora/checkpoint-1000/
